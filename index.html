<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel Administrativo - Andy Obreg√≥n</title>
    <style>
        :root { --primary: #1e293b; --accent: #3b82f6; --danger: #ef4444; --success: #22c55e; --warning: #f59e0b; --text: #f8fafc; }
        body { font-family: 'Segoe UI', sans-serif; background: #0f172a; color: var(--text); margin: 0; padding-bottom: 50px; }

        #login-overlay { position: fixed; top:0; left:0; width:100%; height:100%; background:#0f172a; z-index: 2000; display: flex; align-items: center; justify-content: center; }
        .login-box { background: var(--primary); padding: 30px; border-radius: 12px; width: 90%; max-width: 400px; text-align: center; border: 2px solid var(--accent); }

        .navbar { display: flex; background: var(--primary); padding: 10px; gap: 5px; position: sticky; top: 0; z-index: 1000; overflow-x: auto; border-bottom: 2px solid var(--accent); }
        .nav-btn { background: #334155; color: white; border: none; padding: 10px; border-radius: 6px; cursor: pointer; font-weight: bold; white-space: nowrap; flex: 1; font-size: 0.75rem; }
        .nav-btn.active { background: var(--accent); }

        .container { padding: 15px; }
        .section { display: none; }
        .section.active { display: block; }

        .card { background: #1e293b; border-radius: 8px; padding: 15px; margin-bottom: 20px; border: 1px solid #334155; }
        table { width: 100%; border-collapse: collapse; margin-top: 15px; background: white; color: #333; border-radius: 8px; overflow: hidden; }
        th { background: #1e2d3b; color: white; padding: 10px; font-size: 0.75rem; }
        td { border-bottom: 1px solid #ddd; padding: 8px; font-size: 0.8rem; text-align: center; }

        input, select, textarea { background: #0f172a; border: 1px solid #475569; color: white; padding: 10px; border-radius: 5px; width: 100%; margin-bottom: 10px; box-sizing: border-box; }
        .btn-add { background: var(--success); color: white; width: 100%; padding: 12px; border: none; border-radius: 5px; font-weight: bold; cursor: pointer; }
        
        /* DISE√ëO DE LISTA SEG√öN TU IMAGEN */
        .member-item { display: flex; justify-content: space-between; align-items: center; background: white; color: #333; padding: 15px; margin-bottom: 8px; border-radius: 4px; border-left: 5px solid #eee; }
        .member-info { font-size: 0.85rem; font-weight: 500; flex: 1; }
        .member-btns { display: flex; flex-direction: column; gap: 4px; align-items: flex-end; }
        .btn-edit { background: #ffa500; color: white; border: none; padding: 5px 12px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; cursor: pointer; }
        .btn-del { background: #ef4444; color: white; border: none; padding: 5px 15px; border-radius: 4px; font-size: 0.7rem; font-weight: bold; cursor: pointer; }

        .log-item { border-bottom: 1px solid #334155; padding: 8px; font-size: 0.75rem; }
    </style>
</head>
<body>

<div id="login-overlay">
    <div class="login-box">
        <h2 style="color:var(--accent)">üõ°Ô∏è PANEL ANDY</h2>
        <input type="email" id="login-email" placeholder="Correo">
        <input type="password" id="login-pass" placeholder="Clave">
        <button class="btn-add" onclick="verificarLogin()">ENTRAR</button>
    </div>
</div>

<div id="main-content" style="display:none;">
    <div class="navbar">
        <button class="nav-btn active" onclick="showTab('tab-historial')">üïí HISTORIAL</button>
        <button class="nav-btn" onclick="showTab('tab-vip')">üíé VIP</button>
        <button class="nav-btn" onclick="showTab('tab-socios')">üë• SOCIOS</button>
        <button class="nav-btn" onclick="showTab('tab-stock')">üì¶ STOCK</button>
        <button class="nav-btn" onclick="showTab('tab-resumen')">üìä TOTAL</button>
    </div>

    <div class="container">
        <div id="tab-vip" class="section">
            <div class="card">
                <h3>üíé Cargar Lista de Miembros VIP</h3>
                <textarea id="input-masivo-vip" rows="5" placeholder="Pega aqu√≠ la lista de nombres y n√∫meros..."></textarea>
                <button class="btn-add" style="background:var(--accent);" onclick="cargarVipMasivo()">A√ëADIR A LISTA</button>
            </div>
            
            <div class="card" style="background: transparent; border: none; padding: 0;">
                <div style="background: #f8fafc; color: #1e293b; padding: 10px; display: flex; justify-content: space-between; font-weight: bold; border-radius: 4px 4px 0 0;">
                    <span>Nombre</span>
                    <span>Acciones</span>
                </div>
                <div id="lista-miembros-despliegue"></div>
            </div>
        </div>

        <div id="tab-historial" class="section active">
            <div class="card">
                <h3>üìú Registro de Entregas</h3>
                <div id="historial-lista"></div>
            </div>
        </div>

        <div id="tab-socios" class="section">
            <div class="card">
                <h3>üë• Socios</h3>
                <input type="text" id="s-nom" placeholder="Nombre"><input type="email" id="s-cor" placeholder="Correo"><input type="text" id="s-pas" placeholder="Pass">
                <button class="btn-add" onclick="aggSocio()">CREAR</button>
                <table id="t-socios"><thead><tr><th>Nombre</th><th>Acceso</th><th>Acci√≥n</th></tr></thead><tbody></tbody></table>
            </div>
        </div>

        <div id="tab-stock" class="section">
            <div class="card">
                <h3>üì¶ Inventario</h3>
                <input type="text" id="st-cor" placeholder="Correo"><input type="text" id="st-cla" placeholder="Clave">
                <select id="st-plat"></select>
                <button class="btn-add" onclick="aggStock()">GUARDAR</button>
            </div>
        </div>

        <div id="tab-resumen" class="section">
            <div class="card">
                <h3>üìä Total Stock (0/8)</h3>
                <table id="t-res"><thead><tr><th>Plat</th><th>Cuenta</th><th>Cupo</th><th>Acci√≥n</th></tr></thead><tbody id="b-res"></tbody></table>
            </div>
        </div>
    </div>
</div>

<script>
    let currentAdmin = "";
    let db = JSON.parse(localStorage.getItem('andy_db_final_v10')) || {
        historial: [], vip: [], stock: [], plataformas: ["Netflix", "Disney+", "IPTV"],
        socios: [{nombre: "Andy Obregon", correo: "andyobregon799@gmail.com", pass: "123456", estado: true}]
    };

    function save() { localStorage.setItem('andy_db_final_v10', JSON.stringify(db)); renderAll(); }

    function verificarLogin() {
        let c = document.getElementById('login-email').value;
        let p = document.getElementById('login-pass').value;
        let u = db.socios.find(x => x.correo === c && x.pass === p);
        if(u) { currentAdmin = u.nombre; document.getElementById('login-overlay').style.display='none'; document.getElementById('main-content').style.display='block'; renderAll(); }
    }

    // FUNCI√ìN PARA CARGAR LISTA MASIVA
    function cargarVipMasivo() {
        let texto = document.getElementById('input-masivo-vip').value;
        if(texto) {
            let lineas = texto.split('\n');
            lineas.forEach(l => { if(l.trim()) db.vip.push(l.trim()); });
            document.getElementById('input-masivo-vip').value = "";
            save();
        }
    }

    function editarVip(i) {
        let n = prompt("Editar Miembro:", db.vip[i]);
        if(n) { db.vip[i] = n; save(); }
    }

    function eliminarVip(i) {
        if(confirm("¬øEliminar?")) { db.vip.splice(i, 1); save(); }
    }

    function aggStock() {
        let c = document.getElementById('st-cor').value;
        let k = document.getElementById('st-cla').value;
        let p = document.getElementById('st-plat').value;
        if(c && k) { db.stock.push({plat: p, cuenta: `${c}:${k}`, cupo: 0, max: 8}); save(); }
    }

    function usarCupo(i, miembro) {
        if(db.stock[i].cupo < 8) {
            db.stock[i].cupo++;
            let ahora = new Date();
            db.historial.unshift(`[${ahora.toLocaleDateString()} ${ahora.toLocaleTimeString()}] ${currentAdmin} entreg√≥ ${db.stock[i].plat} a ${miembro}`);
            save();
        }
    }

    function showTab(id) {
        document.querySelectorAll('.section').forEach(s => s.classList.remove('active'));
        document.querySelectorAll('.nav-btn').forEach(b => b.classList.remove('active'));
        document.getElementById(id).classList.add('active');
        event.currentTarget.classList.add('active');
    }

    function renderAll() {
        // Historial
        document.getElementById('historial-lista').innerHTML = db.historial.map(h => `<div class="log-item">${h}</div>`).join('');
        
        // Lista VIP seg√∫n tu imagen
        document.getElementById('lista-miembros-despliegue').innerHTML = db.vip.map((v, i) => `
            <div class="member-item">
                <div class="member-info">${v}</div>
                <div class="member-btns">
                    <button class="btn-edit" onclick="editarVip(${i})">EDITAR</button>
                    <button class="btn-del" onclick="eliminarVip(${i})">X</button>
                </div>
            </div>
        `).join('');

        // Select Plataformas
        document.getElementById('st-plat').innerHTML = db.plataformas.map(p => `<option>${p}</option>`).join('');

        // Resumen
        document.getElementById('b-res').innerHTML = db.stock.map((s, i) => `
            <tr>
                <td>${s.plat}</td>
                <td><small>${s.cuenta}</small></td>
                <td>${s.cupo}/8</td>
                <td><button onclick="resetCupo(${i})">RESET</button></td>
            </tr>
        `).join('');
    }
    
    function resetCupo(i) { db.stock[i].cupo = 0; save(); }

    renderAll();
</script>
</body>
</html>
